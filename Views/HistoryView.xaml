<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:BanHangVip.ViewModels"
             xmlns:models="clr-namespace:BanHangVip.Models"
             x:Class="BanHangVip.Views.HistoryView"
             Title="Lá»‹ch sá»­"
             BackgroundColor="#f8fafc">

    <Grid RowDefinitions="Auto, *">
        <!-- Header - Äá»’NG Bá»˜ KÃCH THÆ¯á»šC -->
        <Grid Grid.Row="0" Padding="20,15" BackgroundColor="White">
            <Grid.Shadow>
                <Shadow Brush="#cbd5e1" Offset="0,2" Radius="4" Opacity="0.1"/>
            </Grid.Shadow>
            <VerticalStackLayout>
                <Label Text="Nháº­t kÃ½ hoáº¡t Ä‘á»™ng" 
                       TextColor="#1e293b" 
                       FontAttributes="Bold" 
                       FontSize="22"/>
                <Label Text="Lá»‹ch sá»­ nháº­p xuáº¥t vÃ  thanh toÃ¡n" 
                       TextColor="#64748b" 
                       FontSize="13"
                       Margin="0,5,0,0"/>
            </VerticalStackLayout>
        </Grid>

        <CollectionView Grid.Row="1" ItemsSource="{Binding HistoryItems}" Margin="15">
            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Vertical" ItemSpacing="12"/>
            </CollectionView.ItemsLayout>
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:HistoryItem">
                    <Border StrokeShape="RoundRectangle 20" 
                            StrokeThickness="0" 
                            BackgroundColor="White" 
                            Padding="15">
                        <Border.Shadow>
                            <Shadow Brush="#cbd5e1" Offset="1,2" Radius="3" Opacity="0.1"/>
                        </Border.Shadow>
                        <Grid ColumnDefinitions="50, *, Auto">
                            <!-- Icon Type -->
                            <Border StrokeShape="RoundRectangle 12" 
                                    BackgroundColor="{Binding Type, Converter={StaticResource TypeToColorConverter}}" 
                                    StrokeThickness="0" 
                                    HeightRequest="50" 
                                    WidthRequest="50">
                                <Label Text="{Binding Type, Converter={StaticResource TypeToIconConverter}}" 
                                       HorizontalOptions="Center" 
                                       VerticalOptions="Center" 
                                       FontSize="20"/>
                            </Border>

                            <!-- Content -->
                            <VerticalStackLayout Grid.Column="1" VerticalOptions="Center" Margin="12,0">
                                <Label Text="{Binding ProductName}" TextColor="#334155" FontAttributes="Bold" FontSize="15"/>
                                <Label Text="{Binding Timestamp, StringFormat='{0:dd/MM HH:mm}'}" TextColor="#94a3b8" FontSize="11"/>
                            </VerticalStackLayout>

                            <!-- Amount -->
                            <VerticalStackLayout Grid.Column="2" VerticalOptions="Center" HorizontalOptions="End">
                                <Label Text="{Binding Weight, StringFormat='{0:+#;-#;0} kg'}" 
                                       TextColor="#0369a1" 
                                       FontAttributes="Bold" 
                                       FontSize="16" 
                                       HorizontalOptions="End"/>
                                <Label Text="{Binding Price, StringFormat='{0:N0} Ä‘'}" 
                                       TextColor="#64748b" 
                                       FontSize="11" 
                                       HorizontalOptions="End"/>
                            </VerticalStackLayout>
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
            <CollectionView.EmptyView>
                <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center" Spacing="10" Margin="0,50,0,0">
                    <Label Text="ðŸ“­" FontSize="50" HorizontalOptions="Center" Opacity="0.5"/>
                    <Label Text="ChÆ°a cÃ³ dá»¯ liá»‡u lá»‹ch sá»­" TextColor="#94a3b8" HorizontalOptions="Center"/>
                </VerticalStackLayout>
            </CollectionView.EmptyView>
        </CollectionView>
    </Grid>
</ContentPage>